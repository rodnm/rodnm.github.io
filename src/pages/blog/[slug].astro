---
import { type CollectionEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { ArrowLeft, Calendar, User, Tag } from 'lucide-react';

export async function getStaticPaths() {
    const posts = await getCollection('blog');
    return posts.map((post) => ({
        params: { slug: post.slug },
        props: post,
    }));
}
type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await post.render();
---

<Layout title={`${post.data.title} - Blog`} description={post.data.description}>
    <article class="py-20 px-4">
        <div class="max-w-3xl mx-auto">
            <a
                href="/blog"
                class="inline-flex items-center gap-2 text-[var(--color-primary)] dark:text-[var(--color-secondary)] hover:underline mb-8"
            >
                <ArrowLeft className="w-4 h-4" />
                Volver al Blog
            </a>

            <header class="mb-12 text-center">
                <div class="flex gap-2 justify-center mb-6">
                    {
                        post.data.tags.map((tag) => (
                            <span class="text-sm font-medium px-3 py-1 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-300 rounded-full flex items-center gap-1">
                                <Tag className="w-3 h-3" />
                                {tag}
                            </span>
                        ))
                    }
                </div>
                <h1
                    class="text-4xl md:text-5xl font-bold mb-6 text-gray-900 dark:text-white leading-tight"
                >
                    {post.data.title}
                </h1>
                <div
                    class="flex items-center justify-center gap-6 text-gray-600 dark:text-gray-400"
                >
                    <div class="flex items-center gap-2">
                        <Calendar className="w-4 h-4" />
                        <time datetime={post.data.pubDate.toISOString()}>
                            {
                                post.data.pubDate.toLocaleDateString('es-ES', {
                                    year: 'numeric',
                                    month: 'long',
                                    day: 'numeric',
                                })
                            }
                        </time>
                    </div>
                    <div class="flex items-center gap-2">
                        <User className="w-4 h-4" />
                        <span>{post.data.author}</span>
                    </div>
                </div>
            </header>

            {
                post.data.image && (
                    <div class="mb-12 rounded-2xl overflow-hidden shadow-lg">
                        <img src={post.data.image} alt={post.data.title} class="w-full h-auto" />
                    </div>
                )
            }

            <div
                class="prose prose-lg dark:prose-invert mx-auto prose-headings:text-[var(--color-primary)] dark:prose-headings:text-[var(--color-secondary)] prose-a:text-[var(--color-secondary)] hover:prose-a:text-[var(--color-primary)]"
            >
                <Content />
            </div>
        </div>
    </article>
</Layout>
